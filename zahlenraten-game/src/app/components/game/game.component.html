<!-- Google Fonts (optional) -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;700&display=swap" rel="stylesheet">

<nav style="display: flex; gap: 10px; margin-bottom: 20px;">
  <button *ngIf="!authService.isLoggedIn()" (click)="goToLogin()">Login</button>
  <button *ngIf="authService.isLoggedIn()" (click)="logout()">Logout</button>
  <button *ngIf="authService.isLoggedIn() && authService.getRole()?.toLowerCase() === 'admin'" (click)="admin()">Manage</button>
</nav>

<!-- Eingeloggt-Anzeige -->
<p *ngIf="authService.isLoggedIn()" style="font-weight: bold;">
  👤 Eingeloggt als: {{ authService.getUsername() }}
  <br>
    Role: {{ authService.getRole() }}

</p>
<!-- Spiel läuft -->
<div class="game-container" *ngIf="!gameOver">
  <div class="numbers">
    <p><strong>Zahl 1:</strong> {{ num1 }}</p>
    <p><strong>Zahl 2:</strong> {{ num2 }}</p>
    <div id="finalNumber"><p><strong>Test-Zahl:</strong> {{ testNum }}</p></div>
  </div>

  <div class="buttons">
    <button class="btn" (click)="guess('inside')">Zwischen</button>
    <button class="btn" (click)="guess('outside')">Außerhalb</button>
  </div>

  <p class="score">Punkte: <span>{{ score }}</span></p>
</div>

<!-- Spiel vorbei -->
<div class="game-over" *ngIf="gameOver">
  <h2>🎯 Game Over!</h2>
  <p class="final-score">Dein Score: <strong>{{ score }}</strong></p>

  <!-- Nur zeigen, wenn es ein Highscore ist UND der Spieler eingeloggt -->
  <div *ngIf="isHighscore && authService.isLoggedIn()" class="highscore-form">
    <button class="btn" (click)="submitScore()">🏅 Highscore speichern</button>
  </div>

  <div *ngIf="!authService.isLoggedIn()" style="color: gray; font-size: 0.9em;">
    <em>👉 <a routerLink="/login">Einloggen</a>, um Highscores zu speichern</em>
  </div>

  <button class="btn restart" (click)="restart()">🔄 Nochmal spielen</button>
</div>

<!-- Highscoreliste -->
<div class="highscores">
  <h3>🏆 Top 10</h3>
  <ul>
    <li *ngIf="topScores.length === 0">Noch keine Highscores vorhanden.</li>
    <li *ngFor="let s of topScores">
      <span>{{ s.username }}</span> – <strong>{{ s.score }} Punkte</strong> <em>({{ s.created_at | date:'short' }})</em>
    </li>
  </ul>
</div>
